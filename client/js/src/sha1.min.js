SSHyClient.hash = {};
SSHyClient.hash.SHA1 = function(a) {
    this.data = a || "";
    this.digest_size = 20
};
SSHyClient.hash.SHA1.prototype = {
    digest: function() {
        var a = toByteArray(this.data),
            h = bytesToWords(a),
            f = 8 * a.length,
            a = [],
            g = 1732584193,
            c = -271733879,
            d = -1732584194,
            e = 271733878,
            k = -1009589776;
        h[f >> 5] |= 128 << 24 - f % 32;
        h[(f + 64 >>> 9 << 4) + 15] = f;
        for (f = 0; f < h.length; f += 16) {
            for (var m = g, n = c, p = d, q = e, r = k, b = 0; 80 > b; b++) {
                if (16 > b) a[b] = h[f + b];
                else {
                    var l = a[b - 3] ^ a[b - 8] ^ a[b - 14] ^ a[b - 16];
                    a[b] = l << 1 | l >>> 31
                }
                l = (g << 5 | g >>> 27) + k + (a[b] >>> 0) + (20 > b ? (c & d | ~c & e) + 1518500249 : 40 > b ? (c ^ d ^ e) + 1859775393 : 60 > b ? (c & d | c & e | d & e) - 1894007588 : (c ^ d ^ e) - 899497514);
                k = e;
                e = d;
                d = c << 30 | c >>> 2;
                c = g;
                g = l
            }
            g += m;
            c += n;
            d += p;
            e += q;
            k += r
        }
        return fromByteArray(wordsToBytes([g, c, d, e, k]))
    }
};
